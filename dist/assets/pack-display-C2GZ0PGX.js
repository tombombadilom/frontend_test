import{p as G,q as $,r as f,u as S,a as T,j as e,L as E,m as y,f as L,B as h,H as R,b,S as _,ak as A}from"./index-A8xx-xxW.js";import{g as q,e as B}from"./catalog-layout-CapVVbF_.js";import{u as K}from"./use-packs-DnZ5cOhr.js";import{s as p}from"./toast-Cu_8kZFb.js";import{C as D,a as M,b as Y}from"./card-DVQQUcVi.js";import{m as x,T as X,S as J}from"./motion-BMEn2pEQ.js";import{C as W,a as H,P as Q,b as U,c as P,d as Z,e as k}from"./pagination-Cxq5DVxe.js";import{u as ee}from"./use-infinite-scroll-DTpYy80u.js";import{C as se}from"./select-pnobd5xa.js";import"./skeleton-D6u_i3Qj.js";import"./packs-DJH6lIvg.js";import"./ellipsis-DGixAxWM.js";import"./index-DNZbadIk.js";import"./check-De8WsGE6.js";const z=G()($(s=>({recentlyViewed:[],addToRecentlyViewed:a=>s(i=>{const j={id:a.id,name:a.name,coverImage:a.coverImage,timestamp:Date.now()},r=i.recentlyViewed.filter(d=>d.id!==a.id).slice(0,9);return{recentlyViewed:[j,...r]}}),clearRecentlyViewed:()=>s({recentlyViewed:[]})}),{name:"pack-history-storage",version:1,migrate:(s,a)=>a===0?{recentlyViewed:[]}:s}));function te({pack:s}){const[a,i]=f.useState(!0),[j,r]=f.useState(!1),{addItem:d}=S(),{addItem:u,removeItem:v,isInWishlist:g}=T(),{addToRecentlyViewed:w}=z(),l=o=>{o.preventDefault(),o.stopPropagation(),d({id:s.id.toString(),name:s.name,price:s.price,image:s.coverImage||"/placeholder.svg",quantity:1}),p.success("Added to cart")},t=o=>{o.preventDefault(),o.stopPropagation(),g(s.id.toString())?(v(s.id.toString()),p.success("Removed from wishlist")):(u(s),p.success("Added to wishlist"))},m=()=>{w(s)};return e.jsx(E,{to:`/packs/${s.id}`,onClick:m,children:e.jsx(y.div,{...x.cards.container,children:e.jsxs(X,{className:"group relative w-full",rotationFactor:x.tilt.rotationFactor,springOptions:x.tilt.springOptions,children:[e.jsx(J,{className:"z-10 from-game-primary/40 via-game-primary/20 to-transparent blur-3xl",size:400,springOptions:{stiffness:20,damping:10}}),e.jsxs(D,{className:"h-full overflow-hidden transition-all hover:shadow-lg border-none",children:[e.jsx(y.div,{className:"relative aspect-[16/9] overflow-hidden",whileHover:x.cards.image.hover,transition:x.cards.image.transition,children:e.jsx("img",{src:s.coverImage||"/placeholder.svg",alt:s.name,className:"h-full w-full object-cover",onError:()=>r(!0),onLoad:()=>i(!1)})}),e.jsxs(M,{className:"p-4",children:[e.jsx("h3",{className:"line-clamp-1 text-lg font-semibold group-hover:text-primary",children:s.name}),e.jsx("p",{className:"mt-2 line-clamp-2 text-sm text-muted-foreground",children:s.description})]}),e.jsx(Y,{className:"p-4 pt-0",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{className:"text-lg font-bold",children:L(s.price)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y.div,{className:"cursor-pointer",whileHover:x.buttons.hover,whileTap:x.buttons.tap,children:e.jsx(h,{size:"icon",variant:"secondary",className:"h-8 w-8 rounded-full opacity-90 hover:opacity-100",onClick:t,children:e.jsx(R,{className:b("h-4 w-4",g(s.id.toString())&&"fill-current text-red-500")})})}),e.jsx(y.div,{className:"cursor-pointer",whileHover:x.buttons.hover,whileTap:x.buttons.tap,children:e.jsx(h,{size:"icon",variant:"secondary",className:"h-8 w-8 rounded-full opacity-90 hover:opacity-100",onClick:l,children:e.jsx(_,{className:"h-4 w-4"})})})]})]})})]})]})})})}function V({packs:s}){return e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:e.jsx(A,{mode:"popLayout",children:s.map((a,i)=>e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:i%4*.1},children:e.jsx(te,{pack:a})},a.id))})})}function ie({pack:s,onPrevious:a,onNext:i}){const[j,r]=f.useState(!0),[d,u]=f.useState(!1),{addItem:v}=S(),{addItem:g,removeItem:w,isInWishlist:l}=T(),{addToRecentlyViewed:t}=z(),m=n=>{n.preventDefault(),n.stopPropagation(),v({id:s.id.toString(),name:s.name,price:s.price,image:s.coverImage||"/placeholder.svg",quantity:1}),p.success("Added to cart")},o=n=>{n.preventDefault(),n.stopPropagation(),l(s.id.toString())?(w(s.id.toString()),p.success("Removed from wishlist")):(g(s),p.success("Added to wishlist"))},N=()=>{t(s)};return e.jsx(E,{to:`/packs/${s.id}`,onClick:N,children:e.jsxs(D,{className:"group relative aspect-[16/9] overflow-hidden border-none",children:[e.jsx("img",{src:s.coverImage||"/placeholder.svg",alt:s.name,className:"h-full w-full object-cover transition-transform duration-300 group-hover:scale-105",onError:()=>u(!0),onLoad:()=>r(!1)}),e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/50 to-transparent p-6 flex flex-col justify-end",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:s.name}),e.jsx("p",{className:"line-clamp-2 text-sm text-white/80 mb-4",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-lg font-bold text-white",children:L(s.price)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{size:"icon",variant:"secondary",className:"h-8 w-8",onClick:o,children:e.jsx(R,{className:b("h-5 w-5",l(s.id.toString())&&"fill-current text-red-500")})}),e.jsx(h,{size:"icon",variant:"secondary",className:"h-8 w-8",onClick:m,children:e.jsx(_,{className:"h-5 w-5"})})]})]})]}),e.jsxs("div",{className:"absolute inset-x-4 top-1/2 -translate-y-1/2 flex justify-between opacity-0 transition-opacity group-hover:opacity-100",children:[a&&e.jsx(h,{variant:"secondary",size:"icon",className:"h-10 w-10 rounded-full bg-black/50 hover:bg-black/70",onClick:n=>{n.preventDefault(),n.stopPropagation(),a()},children:e.jsx(W,{className:"h-6 w-6 text-white"})}),i&&e.jsx(h,{variant:"secondary",size:"icon",className:"h-10 w-10 rounded-full bg-black/50 hover:bg-black/70",onClick:n=>{n.preventDefault(),n.stopPropagation(),i()},children:e.jsx(H,{className:"h-6 w-6 text-white"})})]})]})})}function ae({packs:s,onPrevious:a,onNext:i}){return e.jsx("div",{className:"relative group",children:e.jsx(A,{mode:"popLayout",children:e.jsx(y.div,{initial:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:-100},transition:{duration:.3},children:e.jsx(ie,{pack:s[0],onPrevious:a,onNext:i})},s[0].id)})})}function re({pack:s}){const[a,i]=f.useState(!0),[j,r]=f.useState(!1),{addItem:d}=S(),{addItem:u,removeItem:v,isInWishlist:g}=T(),{addToRecentlyViewed:w}=z(),l=o=>{o.preventDefault(),o.stopPropagation(),d({id:s.id.toString(),name:s.name,price:s.price,image:s.coverImage||"/placeholder.svg",quantity:1}),p.success("Added to cart")},t=o=>{o.preventDefault(),o.stopPropagation(),g(s.id.toString())?(v(s.id.toString()),p.success("Removed from wishlist")):(u(s),p.success("Added to wishlist"))},m=()=>{w(s)};return e.jsx(E,{to:`/packs/${s.id}`,onClick:m,className:"block h-full w-full py-2",children:e.jsxs(D,{className:"grid grid-cols-[60%_1fr] h-full w-full overflow-hidden border-none transition-all hover:bg-accent/5",children:[e.jsx("div",{className:"relative h-full",children:e.jsx("img",{src:s.coverImage||"/placeholder.svg",alt:s.name,className:"absolute inset-0 h-full w-full object-cover",onError:()=>r(!0),onLoad:()=>i(!1)})}),e.jsx(M,{className:"flex flex-col justify-between w-full p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx("h3",{className:"text-lg font-semibold line-clamp-1 flex-1",children:s.name}),e.jsxs("div",{className:"flex gap-2 shrink-0",children:[e.jsx(h,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:t,children:e.jsx(R,{className:b("h-5 w-5",g(s.id.toString())&&"fill-current text-red-500")})}),e.jsx(h,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:l,children:e.jsx(_,{className:"h-5 w-5"})})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description}),e.jsx("p",{className:"text-lg font-semibold",children:L(s.price)})]})})]})})}function ne({packs:s}){const{displayedItems:a,loading:i,hasMore:j,loaderRef:r}=ee({items:s,itemsPerPage:3});return e.jsx("div",{className:"relative flex flex-col h-[calc(100dvh-14rem)] -mx-6",children:e.jsxs("div",{className:"flex-1 flex flex-col overflow-y-auto [scrollbar-width:none] [-ms-overflow-style:none] [&::-webkit-scrollbar]:hidden",children:[e.jsx(A,{mode:"popLayout",children:a.map((d,u)=>e.jsx(y.div,{className:"flex-1 min-h-[28%] px-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:u%4*.1},children:e.jsx(re,{pack:d})},d.id))}),j&&e.jsx("div",{ref:r,className:"h-20 flex items-center justify-center px-6",children:e.jsx(y.div,{animate:i?{rotate:360,scale:[1,1.2,1]}:{y:[0,10,0]},transition:{duration:i?1:1.5,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut"},children:e.jsx(se,{className:b("h-6 w-6",i?"text-primary animate-spin":"text-muted-foreground")})})})]})})}const I=8,oe=4,le=Array.from({length:I},(s,a)=>`skeleton-${a}`),ce=5;function be(){const{packs:s,isLoading:a}=K(),i=q(),j=B(t=>t.displayMode),[r,d]=f.useState(1),[u,v]=f.useState(0),[g,w]=f.useState(oe),l=(s==null?void 0:s.filter(t=>{const m=t.name.toLowerCase().includes(i.search.toLowerCase()),o=i.platforms.length===0||t.tags.some(F=>i.platforms.includes(F)),N=(!i.priceRange[0]||t.price.amount>=i.priceRange[0])&&(!i.priceRange[1]||t.price.amount<=i.priceRange[1]),n=i.games.length===0||i.games.includes(t.gameId.toString()),c=i.types.length===0||i.types.includes(t.type),C=!i.onlyDiscounted||(t.price.discount??0)>0,O=!i.onlyNewReleases||t.isFeatured;return m&&o&&N&&n&&c&&C&&O}))??[];if(a)return e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:le.map(t=>e.jsx("div",{className:"h-[300px] animate-pulse rounded-lg bg-muted"},t))});if(l.length===0)return e.jsx("div",{className:"flex h-40 items-center justify-center rounded-lg border bg-card",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Aucun pack ne correspond à vos critères de recherche."})});switch(j){case"grid":{const t=Math.ceil(l.length/I),m=(r-1)*I,o=m+I,N=l.slice(m,o);let n=[];return t<=ce?n=Array.from({length:t},(c,C)=>C+1):r<=3?n=[1,2,3,4,"ellipsis",t]:r>=t-2?n=[1,"ellipsis",t-3,t-2,t-1,t]:n=[1,"ellipsis",r-1,r,r+1,"ellipsis",t],e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{packs:N}),t>1&&e.jsx(Q,{children:e.jsxs(U,{children:[e.jsx(P,{children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>d(c=>Math.max(1,c-1)),disabled:r===1,children:e.jsx(W,{className:"h-4 w-4"})})}),n.map(c=>e.jsx(P,{children:c==="ellipsis"?e.jsx(Z,{}):e.jsx(k,{onClick:()=>d(c),isActive:r===c,children:c})},typeof c=="number"?c:`ellipsis-${c}`)),e.jsx(P,{children:e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>d(c=>Math.min(t,c+1)),disabled:r===t,children:e.jsx(H,{className:"h-4 w-4"})})})]})})]})}case"carousel":return e.jsx(ae,{packs:[l[u]],onPrevious:()=>v(t=>t===0?l.length-1:t-1),onNext:()=>v(t=>t===l.length-1?0:t+1)});case"infinite":return e.jsx(ne,{packs:l.slice(0,g)});default:return e.jsx(V,{packs:l})}}export{be as PackDisplay};
